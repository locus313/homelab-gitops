services:
  zerobyte:
    image: ghcr.io/nicotsx/zerobyte:v0.28.1
    container_name: zerobyte
    restart: unless-stopped
    networks:
      - proxynet
    cap_add:
      - SYS_ADMIN
    devices:
      - /dev/fuse:/dev/fuse
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_BASE_PATH}/zerobyte:/var/lib/zerobyte
      - ${DOCKER_BASE_PATH}:/docker
      - /mnt:/mnt
    environment:
      PUID: ${PUID}
      PGID: ${PGID}
      TZ: ${TZ}
      # Required: Secret for encrypting database data (v0.23+)
      APP_SECRET: ${APP_SECRET}
      # Required: Base URL for accessing Zerobyte (v0.24+)
      BASE_URL: ${BASE_URL}
      # Optional: Uncomment and configure in .env if needed
      # PORT: 4096
      # RESTIC_HOSTNAME: zerobyte
      # LOG_LEVEL: info
      # SERVER_IDLE_TIMEOUT: 60
      # TRUSTED_ORIGINS:
    labels:
      - traefik.enable=true
      - traefik.http.services.zerobyte.loadbalancer.server.port=4096
      - traefik.http.routers.zerobyte.rule=Host(`zerobyte.${TRAEFIK_BASE_DOMAIN}`)
      - traefik.http.routers.zerobyte.entrypoints=websecure
      - traefik.http.routers.zerobyte.tls=true
      - traefik.http.routers.zerobyte.tls.certresolver=cloudns

networks:
  proxynet:
    external: true
